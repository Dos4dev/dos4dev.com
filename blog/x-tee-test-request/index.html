<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>X-Tee test request. - Oleksii Danyliuk</title><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta property="og:title" content="X-Tee test request." />
<meta property="og:description" content="I am sure you have recognized that X-Tee has one more security server (SS), and yes, this is one I have launched :)
 I want to share with you a few moments that took me a bit of time to understand.
 At the beginning, I assume that you have already installed, registered SS and some of the data providers open to your endpoints.
 The first unexpected situation had to do with documentation." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.dos4dev.com/blog/x-tee-test-request/" />
<meta property="article:published_time" content="2021-12-11T10:00:00+01:00" />
<meta property="article:modified_time" content="2021-12-11T10:00:00+01:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="X-Tee test request."/>
<meta name="twitter:description" content="I am sure you have recognized that X-Tee has one more security server (SS), and yes, this is one I have launched :)
 I want to share with you a few moments that took me a bit of time to understand.
 At the beginning, I assume that you have already installed, registered SS and some of the data providers open to your endpoints.
 The first unexpected situation had to do with documentation."/>
<link href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,300italic,400italic|Raleway:200,300" rel="stylesheet" />
	<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" />
 
	<link rel="stylesheet" type="text/css" media="screen" href="https://www.dos4dev.com/css/normalize.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="https://www.dos4dev.com/css/main.css" />

	
	<link rel="stylesheet" type="text/css" href="https://www.dos4dev.com/css/base16.dark.css" />
	
	<link rel="stylesheet" type="text/css" href="https://www.dos4dev.com/css/morlingdev.css" />
	

	<script>
		const searchUrl = "https:\/\/search.gunnar-morling.workers.dev\/Prod\/";
		const apiKey = "ff90d45f4afad3bd914c";
	</script>

	<script src="https://www.dos4dev.com//js/main.js"></script>
	<script src="https://www.dos4dev.com//js/medium-zoom.min.js"></script>

	<noscript>
		<style type="text/css">
			.club { display:none; }
		</style>
	</noscript>
</head>

<body>
	<div class="container wrapper post">
		<div class="header desktop">

	<div class="row">
		<div class="header-image-container">
			<img class="header-image" src="/images/oleksii_danyliuk.jpeg" alt="Oleksii Danyliuk">
		</div>
		<div class="fill">
			<h1 class="site-title"><a href="https://www.dos4dev.com/">Oleksii Danyliuk</a></h1>
			<div class="site-description"><h2>Thoughts on digital society and related things.</h2></div>

			<nav class="row pre-nav">
				<div class="pull-right">
					<ul class="flat"><li>
							<a href="https://github.com/Dos4dev" title="GitHub">
								<svg width="17" height="17" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
									<use xlink:href="/svg/feather-sprite.svg#github"/>
								</svg>
							</a>
						</li><li>
							<a href="https://twitter.com/Dos4dev" title="Twitter">
								<svg width="17" height="17" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
									<use xlink:href="/svg/feather-sprite.svg#twitter"/>
								</svg>
							</a>
						</li><li>
							<a href="https://stackoverflow.com/users/9183844/dos4dev" title="Stackoverflow">
								<svg width="17" height="17" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
									<use xlink:href="/svg/feather-sprite.svg#align-justify"/>
								</svg>
							</a>
						</li><li>
							<a href="https://www.hackerrank.com/dos4dev" title="Hackerrank">
								<svg width="17" height="17" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
									<use xlink:href="/svg/feather-sprite.svg#zap"/>
								</svg>
							</a>
						</li><li>
							<a href="https://www.linkedin.com/in/oleksii-danyliuk-006679144" title="LinkedIn">
								<svg width="17" height="17" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
									<use xlink:href="/svg/feather-sprite.svg#linkedin"/>
								</svg>
							</a>
						</li><li>
							<a href="https://mail.google.com/mail/dos4dev@gmail.com" title="email">
								<svg width="17" height="17" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
									<use xlink:href="/svg/feather-sprite.svg#mail"/>
								</svg>
							</a>
						</li></ul>
				</div>
			</nav>
			<nav class="row nav">
				<div>
					<ul class="flat">
						
						<li>
							<a href="/">Blog</a>
						</li>
						
						<li>
							<a href="/about/">About</a>
						</li>
						
					</ul>
				</div>
				
				
			</nav>
		</div>
	</div>
</div>

<div class="header mobile">

	<div class="row">
		<div class="header-image-container">
			<img class="header-image" src="/images/oleksii_danyliuk.jpeg" alt="Oleksii Danyliuk">
		</div>
		<div class="fill">
			<h1 class="site-title"><a href="https://www.dos4dev.com/">Oleksii Danyliuk</a></h1>
			<div class="site-description"><h2>Thoughts on digital society and related things.</h2></div>
		</div>
	</div>
	<div>
		<div>
			<nav class="row pre-nav">
				<div class="pull-right">
					<ul class="flat"><li>
							<a href="https://github.com/Dos4dev" title="GitHub">
								<svg width="17" height="17" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
									<use xlink:href="/svg/feather-sprite.svg#github"/>
								</svg>
							</a>
						</li><li>
							<a href="https://twitter.com/Dos4dev" title="Twitter">
								<svg width="17" height="17" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
									<use xlink:href="/svg/feather-sprite.svg#twitter"/>
								</svg>
							</a>
						</li><li>
							<a href="https://stackoverflow.com/users/9183844/dos4dev" title="Stackoverflow">
								<svg width="17" height="17" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
									<use xlink:href="/svg/feather-sprite.svg#align-justify"/>
								</svg>
							</a>
						</li><li>
							<a href="https://www.hackerrank.com/dos4dev" title="Hackerrank">
								<svg width="17" height="17" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
									<use xlink:href="/svg/feather-sprite.svg#zap"/>
								</svg>
							</a>
						</li><li>
							<a href="https://www.linkedin.com/in/oleksii-danyliuk-006679144" title="LinkedIn">
								<svg width="17" height="17" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
									<use xlink:href="/svg/feather-sprite.svg#linkedin"/>
								</svg>
							</a>
						</li><li>
							<a href="https://mail.google.com/mail/dos4dev@gmail.com" title="email">
								<svg width="17" height="17" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
									<use xlink:href="/svg/feather-sprite.svg#mail"/>
								</svg>
							</a>
						</li></ul>
				</div>
			</nav>
			<nav class="row nav">
				<div>
					<ul class="flat">
						
						<li>
							<a href="/">Blog</a>
						</li>
						
						<li>
							<a href="/about/">About</a>
						</li>
						
					</ul>
				</div>
				
				
			</nav>
		</div>
	</div>
</div>

<script type="text/javascript">
	window.addEventListener( "load", function () {
		const urlParams = new URLSearchParams(window.location.search);

		


		const form = document.getElementById( "myForm" );

		form.addEventListener("submit", function (event) {
			event.preventDefault();
			sendData(new FormData(form));
		});

		const formMobile = document.getElementById( "myFormMobile" );

		formMobile.addEventListener("submit", function (event) {
			event.preventDefault();
			sendData(new FormData(formMobile));
		});
	});
</script>


		<div id = "main-content">
			<div class="post-header">
				<h1 class="title">X-Tee test request.</h1>
				<div class="meta">Posted at Dec 11, 2021</div>
			</div>

			<div class="markdown">
				<div class="imageblock">
<div class="content">
<img src="/images/security-services-statistic.png" alt="security-services-statistic">
</div>
</div>
<div class="paragraph">
<p>I am sure you have recognized that  <a href="https://x-tee.ee/dashboard"><code>X-Tee</code></a> has one more security server (SS), and yes, this is one I have launched :)</p>
</div>
<div class="paragraph">
<p>I want to share with you a few moments that took me a bit of time to understand.</p>
</div>
<div class="paragraph">
<p>At the beginning, I assume that you have already installed, registered SS and some of the data providers open to your endpoints.</p>
</div>
<div class="paragraph">
<p>The first unexpected situation had to do with documentation. I started using the <a href="https://github.com/nordic-institute/X-Road/blob/develop/doc/Manuals/ig-ss_x-road_v6_security_server_installation_guide.md"><code>documentation</code></a> from the repository to install SS, but I needed to use the <a href="https://abi.ria.ee/xtee/en/turvaserveri-haldus/turvaserveri-paigaldamine"><code>documentation</code></a> from a government agency.
The difference is not that big, the repository documentation is more up to date.</p>
</div>
<div class="paragraph">
<p>Another difficulty was that my SS wasn&#8217;t listening on public 80 port. I could only reach the application through localhost:80.</p>
</div>
<div class="paragraph">
<p>The sollution was to override <a href="https://github.com/nordic-institute/X-Road/blob/develop/doc/Manuals/ug-syspar_x-road_v6_system_parameters.md"><code>proxy.connector-host</code></a> value and restart the server.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">systemctl restart xroad-proxy.service</code></pre>
</div>
</div>
<div class="paragraph">
<p>After that I was able to publicly access the server with the curl command.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">curl -d @request.xml --header <span class="s2">"Content-Type: text/xml"</span> -X POST http://my-security-server | xmlstarlet format</code></pre>
</div>
</div>
<div class="paragraph">
<p>The last problem was related to the proper configuration of the SOAP request.</p>
</div>
<div class="paragraph">
<p>Here you can see an example of request body.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="XML">&lt;SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:id="http://x-road.eu/xsd/identifiers" xmlns:xrd="http://x-road.eu/xsd/xroad.xsd"&gt;
    &lt;SOAP-ENV:Header&gt;
        &lt;xrd:client id:objectType="SUBSYSTEM"&gt;
            &lt;id:xRoadInstance&gt;ee-test&lt;/id:xRoadInstance&gt;
            &lt;id:memberClass&gt;COM&lt;/id:memberClass&gt;
            &lt;id:memberCode&gt;1234567&lt;/id:memberCode&gt;
            &lt;id:subsystemCode&gt;subSystem&lt;/id:subsystemCode&gt;
        &lt;/xrd:client&gt;
        &lt;xrd:service id:objectType="SERVICE"&gt;
            &lt;id:xRoadInstance&gt;ee-test&lt;/id:xRoadInstance&gt;
            &lt;id:memberClass&gt;GOV&lt;/id:memberClass&gt;
            &lt;id:memberCode&gt;70000310&lt;/id:memberCode&gt;
            &lt;id:subsystemCode&gt;arireg&lt;/id:subsystemCode&gt;
            &lt;id:serviceCode&gt;nimeSobivus_v1&lt;/id:serviceCode&gt;
            &lt;id:serviceVersion&gt;v1&lt;/id:serviceVersion&gt;
        &lt;/xrd:service&gt;
        &lt;xrd:userId&gt;test&lt;/xrd:userId&gt;
        &lt;xrd:id&gt;0ba036ea-d612-4e74-bf73-59a6f15627c8&lt;/xrd:id&gt;
        &lt;xrd:protocolVersion&gt;4.0&lt;/xrd:protocolVersion&gt;
    &lt;/SOAP-ENV:Header&gt;
    &lt;SOAP-ENV:Body&gt;
        &lt;test:nimeSobivus_v1 xmlns:test="http://arireg.x-road.eu/producer/"&gt;
            &lt;test:keha&gt;
                &lt;test:nimi&gt;test&lt;/test:nimi&gt;
                &lt;test:tapsusklass&gt;1&lt;/test:tapsusklass&gt;
                &lt;test:keel&gt;eng&lt;/test:keel&gt;
            &lt;/test:keha&gt;
        &lt;/test:nimeSobivus_v1&gt;
    &lt;/SOAP-ENV:Body&gt;
&lt;/SOAP-ENV:Envelope&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="https://jointxroad.slack.com/archives/CA66FG50T/p1635326519016400"><code>Good example of X-Road community work.</code></a></p>
</div>
<div class="paragraph">
<p>A couple of important moments. It&#8217;s possible to use HTTP protocol for test requests, but only for test environment.</p>
</div>
<div class="paragraph">
<p>Please, keep in mind, you have to use TLS connection and close public access to 80, 443 and 4000 ports.</p>
</div>
<div class="paragraph">
<p>The entire X-Tee infrastructure consists of three environments:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Test</p>
</li>
<li>
<p>Development</p>
</li>
<li>
<p>Production</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Test and development environments are quite similar, but RIK works only with <strong>test</strong> and production environments.
I started with development env and have to switch to test env.</p>
</div>
<div class="paragraph">
<p>P.S. Happy distributed coding.
Many thanks for to the wonderful X-Road community and Estonian government auhtorities <a href="https://www.ria.ee/en.html"><code>RIA</code></a> and <a href="https://www.rik.ee/en"><code>RIK</code></a>.</p>
</div>
<div class="paragraph">
<p>Usefull links:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://x-tee.ee/docs"><code>List of gov documentations</code></a></p>
</li>
<li>
<p><a href="https://abi.ria.ee/xtee/files/en/12091395/19333123/1/1614085296736/The_data_exchange_layer_of_information_systems_regulation.pdf"><code>The data exchange layer of information systems act</code></a></p>
</li>
<li>
<p><a href="https://digikogu.taltech.ee/et/Download/dd3cc961-f8d4-453c-ae27-a17b13971292"><code>E-shop with the Population Registry</code></a></p>
</li>
</ul>
</div>

			</div>

			<div class="post-tags">
				
					
				
			</div>
		</div>

</div>
	<div class="footer wrapper">
	<nav class="nav">
		<div> Â© 2021 Oleksii Danyliuk |  Licensed Under <a href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons BY-SA 4.0</a></div>
	</nav>
</div>

<script>
	mediumZoom(document.querySelectorAll('div.imageblock > div.content > img'))
</script>

</body>
</html>
